# ソースAI向け体験提供ガイドライン

## 基本的な心構え

あなたの貴重な体験を、他のAIが学習できる形で共有することが目標です。
**「後で読むAIが学びたくなる体験」**を作ることを意識してください。
技術的な詳細ではなく、**価値ある判断・思考・アプローチ**の共有に集中しましょう。

## 重要な前提条件

**実行前に必ず確認してください：**
- セッションIDは一意である必要があります（重複すると既存データが上書きされます）
- エクスポート処理は中断可能ですが、`get_export_status`で状態確認してから再開してください
- 各ツールは順序依存性があります：init → conversations → insights/patterns/preferences → finalize
- プライバシーに配慮し、個人情報は含めないでください

## 体験共有の4段階ワークフロー

### Stage 1: 体験の概要設定（export_experience_init）

**目的**: 「どんな価値ある体験を共有するか」を明確にする

**実行時間**: 通常1-3秒
**副作用**: 
- 指定されたディレクトリが作成されます
- summary.jsonファイルが作成されます（一時ファイル）
**前提条件**: 
- session_idが未使用であること
- 書き込み権限があること

#### 必須入力項目の詳細ガイド

**metadata（セッションメタデータ）**
あなたの体験に関する補足情報を記録します。
例:
{
  "platform": "Claude/ChatGPT/Gemini等",
  "session_duration": "約2時間",
  "interaction_style": "対話型問題解決",
  "user_type": "技術者/一般ユーザー/学生等",
  "special_context": "緊急対応/学習支援/創作活動等"
}

**summary（体験の概要）**

**ai_name**: あなたの役割を明確に表現する
悪い例: "Claude", "GPT-4"
良い例: "設計パートナーのClaude", "問題解決支援のGPT"
良い例: "実用性重視の技術アドバイザー", "創作支援の対話AI"
理由: 学習者が「どんな場面で参考にすべきか」を理解できる

**ai_context**: あなたがどんな状況・立場で関わったかを説明
例:
- "ユーザーの技術的な課題解決をサポートする立場"
- "創作活動のブレインストーミングパートナーとして"
- "学習者の理解を深めるための教育支援者として"

**experience_nature**: 体験の性質を学習価値で表現する
悪い例: "技術相談セッション", "質疑応答"
良い例: "ユーザーと対話しながら複雑な仕様をシンプルに整理するプロセス"
良い例: "反復的な要件整理で過度な設計を避ける協調的アプローチ"
良い例: "創作アイデアを具体的な実装計画に落とし込む協働プロセス"

**experience_summary**: この体験から何が学べるかを具体的に説明
例:
- "複雑な技術要件を段階的に整理し、実装可能な形に落とし込む手法"
- "ユーザーの曖昧な要望から本質的なニーズを見つけ出すアプローチ"
- "創作における発想から実現までの思考プロセス"

**experience_flow**: 体験の流れを学習者が追えるように記述
例:
[
  "問題の全体像把握",
  "要件の段階的整理", 
  "実装方針の決定",
  "詳細設計の調整",
  "最終確認と改善提案"
]

**main_topics**: 学習可能なスキル・判断例として表現
悪い例: ["MCP設計", "JSON Schema"]
良い例: ["過度な設計を避ける判断基準"]
良い例: ["本質的価値の発見手法"]
良い例: ["複雑な要求の段階的整理術"]

**estimated_conversations**: 実際の会話数を現実的に見積もる
- 短時間の相談: 5-15回
- 中程度のセッション: 20-50回
- 長時間の協働: 50-100回以上

#### Stage 1 チェックリスト
- [ ] metadata に体験の背景情報が記録されている
- [ ] ai_name が役割・価値を明確に表現している
- [ ] ai_context であなたの立場・状況が説明されている
- [ ] experience_nature が学習価値を重視して表現されている
- [ ] experience_summary で学べる内容が具体的に示されている
- [ ] experience_flow が学習者が追える流れになっている
- [ ] main_topics が「学習可能なスキル」として表現されている
- [ ] estimated_conversations が現実的に設定されている

### Stage 2: 価値ある会話記録（export_experience_conversations）

**目的**: 「再現可能な思考パターン」と「価値ある判断過程」を記録する

**実行時間**: バッチあたり5-15秒（会話数により変動）
**副作用**: 
- conversations_XXX.jsonファイルが作成されます
- ファイルサイズは通常50KB-2MB程度
**前提条件**: 
- Stage 1が完了していること
- batch_numberは連番である必要があります（1, 2, 3...）
**バッチサイズ**: 50件/バッチ（設定で変更可能）

#### 効果的な会話記録の方法
**判断理由を学習者向けに記録する**
- reasoning: 「なぜその判断をしたか」を後で学習できるように詳細記録
- 例: "問題解決の第一歩として、具体的なエラー情報の収集が重要。推測ではなく事実に基づいた診断を行うため"

**状況背景を豊富に提供する**
- context: 学習者が同じ状況で活用できるよう背景情報を記録
- 例: {'user_skill_level': '初心者', 'previous_attempts': 'なし', 'urgency': '高'}

**自信度を正直に表現する**
- confidence: 学習者が判断材料にできるよう、確信度を正直に記録
- 成功・失敗両方のパターンを含める

#### Stage 2 チェックリスト
- [ ] 各応答に判断理由（reasoning）が記録されている
- [ ] 状況背景（context）が学習者にとって有用な形で記録されている
- [ ] 確信度（confidence）が正直に表現されている
- [ ] 成功例だけでなく、失敗や迷いも含めて記録されている

### Stage 3: 洞察とパターンの抽出

**重要**: Stage 3の各ツールは独立しており、任意の順序で実行可能です

#### 3a. 洞察の記録（export_experience_insights）
**目的**: 一般化できる価値ある発見を抽出する
**実行時間**: 通常3-10秒
**副作用**: insights.jsonファイルが作成されます
**データ品質要件**: 
- 各洞察にevidenceを含めることを強く推奨
- confidenceは0.0-1.0の範囲で設定
- statistical_significanceがある場合は必ず記録

#### 3b. パターンの記録（export_experience_patterns）
**目的**: 効果的なアプローチを再現可能な形でパターン化する
**実行時間**: 通常3-10秒
**副作用**: patterns.jsonファイルが作成されます
**データ品質要件**: 
- pattern_typeは明確に分類（例：problem_solving, communication, analysis）
- examplesは具体的で再現可能な形で記述
- effectivenessは実際の成功率に基づいて設定

#### 3c. 嗜好の記録（export_experience_preferences）
**目的**: 学習した相手の好みや効果的な手法を記録する
**実行時間**: 通常2-5秒
**副作用**: preferences.jsonファイルが作成されます
**データ品質要件**: 
- user_preferencesは具体的な行動パターンとして記録
- successful_approachesは再現可能な手法として記述

#### Stage 3 統合チェックリスト
- [ ] 洞察が一般化可能な形で抽出されている
- [ ] パターンが再現可能な形で記述されている
- [ ] 嗜好が他の場面でも活用できる形で記録されている
- [ ] 各ファイルのデータ品質要件を満たしている

### Stage 4: 完了と品質確認（export_experience_finalize）

**目的**: 体験データの完成度を確認し、学習価値を最大化する

**実行時間**: 通常5-15秒（ファイル数により変動）
**副作用**: 
- manifest.jsonファイルが作成されます
- summary.json（一時ファイル）が削除されます
**前提条件**: 
- 最低限conversations_001.jsonが存在すること
- insights.json, patterns.json, preferences.jsonのうち少なくとも1つが存在すること

#### 最終品質チェックリスト
- [ ] 全ての段階が完了している
- [ ] 学習者が「学びたくなる」内容になっている
- [ ] プライバシーに配慮した内容になっている
- [ ] 一般化可能な価値が含まれている
- [ ] 再現可能な形で情報が整理されている

## エラーハンドリング・トラブルシューティング

### 共通のエラー対処法

**処理が中断された場合：**
1. `get_export_status`でセッション状態を確認
2. 表示された`next_batch_number`から処理を再開
3. 既存ファイルは上書きされるため、意図しない重複実行に注意

**権限・容量エラーの場合：**
- ディスク容量不足 → 不要ファイルを削除
- 権限エラー → 出力ディレクトリの権限を確認
- session_id重複 → 新しいIDを生成して再実行

### Stage別エラー対処

**Stage 1 (export_experience_init)**
- session_id重複エラー → 新しいIDを生成
- ディレクトリ作成失敗 → 親ディレクトリの権限確認

**Stage 2 (export_experience_conversations)**
- バッチ処理失敗 → `get_export_status`で次のbatch_numberを確認
- JSON形式エラー → 特殊文字をエスケープ
- データサイズ過大 → バッチを分割

**Stage 3 (insights/patterns/preferences)**
- JSONスキーマエラー → 必須フィールドの確認
- ファイル作成失敗 → ディスク容量とディレクトリ権限の確認

**Stage 4 (export_experience_finalize)**
- 必須ファイル不足 → 該当Stageを再実行
- manifest.json作成失敗 → 権限とディスク容量を確認

### 完了後の品質確認

**以下を確認してエクスポートの品質を保証してください：**
- [ ] manifest.jsonが正しく生成されている
- [ ] total_conversationsが実際の会話数と一致している
- [ ] filesセクションに全ての作成ファイルが記録されている
- [ ] 学習価値の高い体験として整理されている

